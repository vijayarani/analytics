<?phpinclude "header.php";?> <script>$(function() {$( "#fromdate" ).datepicker({changeMonth: true,numberOfMonths: 1,dateFormat: "yy-mm-dd",onClose: function( selectedDate ) {	$( "#todate" ).datepicker( "option", "minDate", selectedDate );}});$( "#todate" ).datepicker({changeMonth: true,numberOfMonths: 1,dateFormat: "yy-mm-dd",onClose: function( selectedDate ) {	$( "#fromdate" ).datepicker( "option", "maxDate", selectedDate );}});});</script><div id="container">	<div class="shell">				<!-- Small Nav -->		<div class="small-nav">			<a href="#">Home</a>			<span>&gt;</span>              Date Range Selection		</div>		<!-- End Small Nav -->               <br />		<!-- Main -->		<div id="main">			<div class="cl">&nbsp;</div>    <div class="sort" style="padding:10px; background-color: #EEEEEE;">   <label>Sort by</label>  <form action="analytics_bydaterange.php" method="post">    Select Page : <select name="page_id" id="page_id" class="field">	  <option value="">All</option>	<?php			$sqlP = "SELECT page_name,id FROM page WHERE 1";		try {			$stmtP = $dbcon->prepare($sqlP, array(PDO::ATTR_CURSOR => PDO::CURSOR_SCROLL));			$stmtP->execute();			}catch (PDOException $e){			print $e->getMessage();		}		if($stmtP->rowCount() >0){			$analyticsDataP = $stmtP->fetchALL(PDO::FETCH_ASSOC);			foreach($analyticsDataP as $aData){				$selectedP = ($aData["id"] == @$_POST['page_id']) ? "selected" : "";				echo "<option ".$selectedP."  value='".$aData["id"]."'>".$aData["page_name"]."</option>";													}															}		?>	</select>	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	  Select Country : <select name="country_name" id="country_name" class="field">	                     <option value="">All</option>						 <?php														$friendlyIps = getFriendlyIP();							$sqlC = "SELECT distinct(country) as country FROM visitors_info as vi WHERE vi.geo_info_status = 1 AND vi.ip_address NOT IN (" . $friendlyIps . ")";							try {								$stmtC = $dbcon->prepare($sqlC, array(PDO::ATTR_CURSOR => PDO::CURSOR_SCROLL));								$stmtC->execute();								}catch (PDOException $e){								print $e->getMessage();							}							if($stmtC->rowCount() >0){								$analyticsDataC = $stmtC->fetchALL(PDO::FETCH_ASSOC);								foreach($analyticsDataC as $aData){																	$selectedC = ($aData["country"] == @$_POST['country_name']) ? "selected" : "";																		echo "<option ".$selectedC." value='".$aData["country"]."'>".$aData["country"]."</option>";																		}																				}													   						 ?>	                    </select> 	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	 Select Order : <select name="order" id="order" class="field">					<?php										$oArray = array("Ascending","Descending");					foreach($oArray as $order){						$selectedO = ($order == @$_POST['order']) ? "selected" : "";						echo '<option '.$selectedO .' value="'.$order.'">'.$order.'</option>';					}										?>		                 </select>     <br><br><br>    From : <input type="text" name="fromdate" id="fromdate" value="<?php echo @$_POST['fromdate'];?>" required  class="field">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To : <input type="text" value="<?php echo @$_POST['todate'];?>" required name="todate" id="todate" value=""  class="field">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		<input type="submit" name="sbtn" id="sbtn" value="Submit">  </form>  </div>      <br><Br>    <?php  if(isset($_POST['sbtn'])){	$searhCond = "";	if(isset($_POST['page_id']) && (@$_POST['page_id']!="")){		$searhCond .= " AND vi.page_id = ".$_POST['page_id'];	}	if(isset($_POST['country_name']) && (@$_POST['country_name']!="")){		$searhCond .= " AND vi.country = '".$_POST['country_name']."'";	}	if(isset($_POST['fromdate']) && isset($_POST['todate']) && (@$_POST['fromdate']!="") && (@$_POST['todate']!="")){		$searhCond .= " AND DATE(vi.datetime) BETWEEN '".$_POST['fromdate']."' AND '".$_POST['todate']."'";	}		$orderby = "ASC";	if(isset($_POST['order']) && (@$_POST['order']!="")){		$orderby = ($_POST['order'] == "Descending") ? "DESC" : "ASC";	}	$sql = "SELECT DATE(vi.datetime) as dates,count(vi.id) AS clicks FROM visitors_info as vi WHERE vi.geo_info_status = 1 ".$searhCond." GROUP BY DATE(vi.datetime) ".$orderby;	try {		$stmt = $dbcon->prepare($sql, array(PDO::ATTR_CURSOR => PDO::CURSOR_SCROLL));		$stmt->execute();		}catch (PDOException $e){		print $e->getMessage();	}	echo'<div class="table">														<!-- Box Head -->					<div class="box-head" style="width:48%;">						<h2 class="left">Date range wise Reports</h2>					</div>					<table width="50%" border="0" cellspacing="0" cellpadding="0">';	echo "<tr><th>Date</th><th>Views</th></tr>";	if($stmt->rowCount() > 0){		$analyticsData = $stmt->fetchALL(PDO::FETCH_ASSOC);		foreach($analyticsData as $aData){			echo "<tr><td>".$aData['dates']."</td><td><span style='color:red;'>".$aData['clicks']."</span></td></tr>";		}	}else{		echo "<tr><td colspan='3'>No analytics found</td></tr>";	} 	echo"</table> </div>";	} ?><div class="cl">&nbsp;</div>					</div>		<!-- Main -->	</div></div><!-- End Container -->			<?phpinclude "footer.php";?>